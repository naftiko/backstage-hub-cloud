apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Submits A Sql Statement For Execution.
  description: >-
    Submits one or more statements for execution. You can specify that the
    statement should be executed asynchronously.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Submits A Sql Statement For Execution.
      description: >-
        Submits one or more statements for execution. You can specify that the
        statement should be executed asynchronously.
    paths:
      /api/v2/statements:
        post:
          summary: Submits A Sql Statement For Execution.
          description: >-
            Submits one or more statements for execution. You can specify that the
            statement should be executed asynchronously.
          operationId: submitStatement
          requestBody:
            description: Specifies the SQL statement to execute and the statement context.
            required: true
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    statement:
                      description: >-
                        SQL statement or batch of SQL statements to execute. You can
                        specify query, DML and DDL statements. The following
                        statements are not supported: PUT, GET, USE, ALTER SESSION,
                        BEGIN, COMMIT, ROLLBACK, statements that set session
                        variables, and statements that create temporary tables and
                        stages.
                      type: string
                    timeout:
                      description: >-
                        Timeout in seconds for statement execution. If the execution
                        of a statement takes longer than the specified timeout, the
                        execution is automatically canceled. To set the timeout to
                        the maximum value (604800 seconds), set timeout to 0.
                      type: integer
                      format: int64
                      minimum: 0
                      example: 10
                    database:
                      description: >-
                        Database in which the statement should be executed. The
                        value in this field is case-sensitive.
                      type: string
                      example: TESTDB
                    schema:
                      description: >-
                        Schema in which the statement should be executed. The value
                        in this field is case-sensitive.
                      type: string
                      example: TESTSCHEMA
                    warehouse:
                      description: >-
                        Warehouse to use when executing the statement. The value in
                        this field is case-sensitive.
                      type: string
                      example: TESTWH
                    role:
                      description: >-
                        Role to use when executing the statement. The value in this
                        field is case-sensitive.
                      type: string
                      example: TESTROLE
                    bindings:
                      description: >-
                        Values of bind variables in the SQL statement. When
                        executing the statement, Snowflake replaces placeholders
                        ('?' and ':name') in the statement with these specified
                        values.
                      type: object
                      properties: {}
                      example:
                        '1':
                          type: FIXED
                          value: '123'
                        '2':
                          type: TEXT
                          value: teststring
                    parameters:
                      description: >-
                        Session parameters that should be set before executing the
                        statement.
                      type: object
                      properties:
                        timezone:
                          description: Time zone to use when executing the statement.
                          type: string
                          example: america/los_angeles
                        query_tag:
                          description: >-
                            Query tag that you want to associate with the SQL
                            statement.
                          type: string
                          example: tag-1234
                        binary_output_format:
                          description: Output format for binary values.
                          type: string
                          example: HEX
                        date_output_format:
                          description: Output format for DATE values.
                          type: string
                          example: YYYY-MM-DD
                        time_output_format:
                          description: Output format for TIME values.
                          type: string
                          example: HH24:MI:SS.FF6
                        timestamp_output_format:
                          description: Output format for TIMESTAMP values.
                          type: string
                          example: YYYY-MM-DDTHH24:MI:SS.FF6
                        timestamp_ltz_output_format:
                          description: Output format for TIMESTAMP_LTZ values.
                          type: string
                          example: YYYY-MM-DDTHH24:MI:SS.FF6
                        timestamp_ntz_output_format:
                          description: Output format for TIMESTAMP_NTZ values.
                          type: string
                          example: YYYY-MM-DDTHH24:MI:SS.FF6
                        timestamp_tz_output_format:
                          description: Output format for TIMESTAMP_TZ values.
                          type: string
                          example: YYYY-MM-DDTHH24:MI:SS.FF6 TZHTZM
                        multi_statement_count:
                          description: >-
                            Number of statements to execute when using
                            multi-statement capability. 0 implies variable number of
                            statements. Negative numbers are not allowed.
                          type: integer
                          example: 4
                          default: 1
                example:
                  statement: select * from T where c1=?
                  timeout: 10
                  database: TESTDB
                  schema: TESTSCHEMA
                  warehouse: TESTWH
                  bindings:
                    '1':
                      type: FIXED
                      value: '123'
          responses:
            '504':
              $ref: '#/components/responses/504GatewayTimeout'
