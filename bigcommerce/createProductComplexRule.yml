apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Create A Complex Rule
  description: >-
    Creates a product *Complex Rule*.**Required Fields**- modifier_id-
    modifier_value_id- variant_id**Read-Only Fields**- complex_rule_id-
    conditions_id- rule_id- combination_id- id
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Create A Complex Rule
      description: >-
        Creates a product *Complex Rule*.**Required Fields**- modifier_id-
        modifier_value_id- variant_id**Read-Only Fields**- complex_rule_id-
        conditions_id- rule_id- combination_id- id
    paths:
      /catalog/products/{product_id}/complex-rules:
        post:
          summary: Create A Complex Rule
          description: >-
            Creates a product *Complex Rule*.**Required Fields**- modifier_id-
            modifier_value_id- variant_id**Read-Only Fields**- complex_rule_id-
            conditions_id- rule_id- combination_id- id
          operationId: createProductComplexRule
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  title: Complex Rule
                  type: object
                  properties:
                    product_id:
                      type: integer
                      description: >
                        The unique numeric ID of the product with which the rule is
                        associated; increments sequentially.
                      nullable: true
                      example: 67
                      x-required:
                        - post
                        - put
                    sort_order:
                      maximum: 2147483647
                      minimum: -2147483648
                      type: integer
                      description: >
                        The priority to give this rule when making adjustments to
                        the product properties.
                      example: 0
                    enabled:
                      type: boolean
                      description: >
                        Flag for determining whether the rule is to be used when
                        adjusting a productÊ¼s price, weight, image, or availabilty.
                      example: true
                    stop:
                      type: boolean
                      description: >
                        Flag for determining whether other rules should not be
                        applied after this rule has been applied.
                    purchasing_disabled:
                      type: boolean
                      description: >
                        Flag for determining whether the rule should disable
                        purchasing of a product when the conditions are applied.
                    purchasing_disabled_message:
                      maxLength: 255
                      minLength: 0
                      type: string
                      description: >
                        Message displayed on the storefront when a rule disables the
                        purchasing of a product.
                      example: This product is not available at this time.
                    purchasing_hidden:
                      type: boolean
                      description: >
                        Flag for determining whether the rule should hide purchasing
                        of a product when the conditions are applied.
                    image_url:
                      type: string
                      description: >
                        The URL for an image displayed on the storefront when the
                        conditions are applied. Limit of 8MB per file.
                      example: >-
                        https://cdn8.bigcommerce.com/s-123456/product_images/d/fakeimage.png
                    price_adjuster:
                      title: Adjuster
                      type: object
                      properties:
                        adjuster:
                          type: string
                          description: >
                            The type of adjuster for either the price or the weight
                            of the variant, when the modifier value is selected on
                            the storefront.
                          nullable: true
                          enum:
                            - relative
                            - percentage
                        adjuster_value:
                          type: number
                          description: >
                            The numeric amount by which the adjuster will change
                            either the price or the weight of the variant, when the
                            modifier value is selected on the storefront.
                          example: 5
                      description: Adjuster for Complex Rules.
                    weight_adjuster:
                      title: Adjuster
                      type: object
                      properties:
                        adjuster:
                          type: string
                          description: >
                            The type of adjuster for either the price or the weight
                            of the variant, when the modifier value is selected on
                            the storefront.
                          nullable: true
                          enum:
                            - relative
                            - percentage
                        adjuster_value:
                          type: number
                          description: >
                            The numeric amount by which the adjuster will change
                            either the price or the weight of the variant, when the
                            modifier value is selected on the storefront.
                          example: 5
                      description: Adjuster for Complex Rules.
                    conditions:
                      type: array
                      items:
                        title: Complex Rule Condition
                        required:
                          - modifier_id
                          - modifier_value_id
                          - variant_id
                        type: object
                        properties:
                          modifier_id:
                            type: integer
                            description: >-
                              The unique numeric ID of the modifier with which the
                              rule condition is associated.

                              Required in /POST.
                            nullable: true
                            example: 55
                          modifier_value_id:
                            type: integer
                            description: >-
                              The unique numeric ID of the modifier value with which
                              the rule condition is associated.

                              Required in /POST.
                            nullable: true
                            example: 256
                          variant_id:
                            type: integer
                            description: >-
                              The unique numeric ID of the variant with which the
                              rule condition is associated.

                              Required in /POST.
                            nullable: true
                            example: 1
                  description: Common ComplexRule properties.
          responses:
            '422':
              description: >
                The `ComplexRule` was not valid. This is the result of missing
                required fields, or of invalid data. See the response for more
                details.
              content:
                application/json:
                  schema:
                    title: Error Response
                    type: object
                    properties:
                      errors:
                        title: Detailed Errors
                        type: object
                        properties: {}
                        additionalProperties: true
                      instance:
                        type: string
                      status:
                        type: integer
                        description: |
                          The HTTP status code.
                      title:
                        type: string
                        description: |
                          The error title describing the particular error.
                      type:
                        type: string
