apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Get-or-create An Authorization For A Specific App
  description: >-
    **Deprecation Notice:** GitHub Enterprise Server will discontinue the [OAuth
    Authorizations
    API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations/),
    which is used by integrations to create personal access tokens and OAuth
    tokens, and you must now create these tokens using our [web application
    flow](https://docs.github.com/enterprise-server@3.9/developers/apps/authorizing-oauth-apps#web-application-flow).
    The [OAuth Authorizations
    API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations)
    will be removed on November, 13, 2020. For more information, including
    scheduled brownouts, see the [blog
    post](https://developer.github.com/changes/2020-02-14-deprecating-oauth-auth-endpoint/).**Warning:**
    Apps must use the [web application
    flow](https://docs.github.com/enterprise-server@3.9/apps/building-oauth-apps/authorizing-oauth-apps/#web-application-flow)
    to obtain OAuth tokens that work with GitHub Enterprise Server SAML
    organizations. OAuth tokens created using the Authorizations API will be
    unable to access GitHub Enterprise Server SAML organizations. For more
    information, see the [blog
    post](https://developer.github.com/changes/2019-11-05-deprecated-passwords-and-authorizations-api).Creates
    a new authorization for the specified OAuth application, only if an
    authorization for that application doesn't already exist for the user. The
    URL includes the 20 character client ID for the OAuth app that is requesting
    the token. It returns the user's existing authorization for the application
    if one is present. Otherwise, it creates and returns a new one.If you have
    two-factor authentication setup, Basic Authentication for this endpoint
    requires that you use a one-time password (OTP) and your username and
    password instead of tokens. For more information, see "[Working with
    two-factor
    authentication](https://docs.github.com/enterprise-server@3.9/rest/overview/other-authentication-methods#working-with-two-factor-authentication)."**Deprecation
    Notice:** GitHub Enterprise Server will discontinue the [OAuth
    Authorizations
    API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations/),
    which is used by integrations to create personal access tokens and OAuth
    tokens, and you must now create these tokens using our [web application
    flow](https://docs.github.com/enterprise-server@3.9/developers/apps/authorizing-oauth-apps#web-application-flow).
    The [OAuth Authorizations
    API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations)
    will be removed on November, 13, 2020. For more information, including
    scheduled brownouts, see the [blog
    post](https://developer.github.com/changes/2020-02-14-deprecating-oauth-auth-endpoint/).
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Get-or-create An Authorization For A Specific App
      description: >-
        **Deprecation Notice:** GitHub Enterprise Server will discontinue the [OAuth
        Authorizations
        API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations/),
        which is used by integrations to create personal access tokens and OAuth
        tokens, and you must now create these tokens using our [web application
        flow](https://docs.github.com/enterprise-server@3.9/developers/apps/authorizing-oauth-apps#web-application-flow).
        The [OAuth Authorizations
        API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations)
        will be removed on November, 13, 2020. For more information, including
        scheduled brownouts, see the [blog
        post](https://developer.github.com/changes/2020-02-14-deprecating-oauth-auth-endpoint/).**Warning:**
        Apps must use the [web application
        flow](https://docs.github.com/enterprise-server@3.9/apps/building-oauth-apps/authorizing-oauth-apps/#web-application-flow)
        to obtain OAuth tokens that work with GitHub Enterprise Server SAML
        organizations. OAuth tokens created using the Authorizations API will be
        unable to access GitHub Enterprise Server SAML organizations. For more
        information, see the [blog
        post](https://developer.github.com/changes/2019-11-05-deprecated-passwords-and-authorizations-api).Creates
        a new authorization for the specified OAuth application, only if an
        authorization for that application doesn't already exist for the user. The
        URL includes the 20 character client ID for the OAuth app that is requesting
        the token. It returns the user's existing authorization for the application
        if one is present. Otherwise, it creates and returns a new one.If you have
        two-factor authentication setup, Basic Authentication for this endpoint
        requires that you use a one-time password (OTP) and your username and
        password instead of tokens. For more information, see "[Working with
        two-factor
        authentication](https://docs.github.com/enterprise-server@3.9/rest/overview/other-authentication-methods#working-with-two-factor-authentication)."**Deprecation
        Notice:** GitHub Enterprise Server will discontinue the [OAuth
        Authorizations
        API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations/),
        which is used by integrations to create personal access tokens and OAuth
        tokens, and you must now create these tokens using our [web application
        flow](https://docs.github.com/enterprise-server@3.9/developers/apps/authorizing-oauth-apps#web-application-flow).
        The [OAuth Authorizations
        API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations)
        will be removed on November, 13, 2020. For more information, including
        scheduled brownouts, see the [blog
        post](https://developer.github.com/changes/2020-02-14-deprecating-oauth-auth-endpoint/).
    paths:
      /authorizations/clients/{client_id}:
        put:
          summary: Get-or-create An Authorization For A Specific App
          description: >-
            **Deprecation Notice:** GitHub Enterprise Server will discontinue the
            [OAuth Authorizations
            API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations/),
            which is used by integrations to create personal access tokens and OAuth
            tokens, and you must now create these tokens using our [web application
            flow](https://docs.github.com/enterprise-server@3.9/developers/apps/authorizing-oauth-apps#web-application-flow).
            The [OAuth Authorizations
            API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations)
            will be removed on November, 13, 2020. For more information, including
            scheduled brownouts, see the [blog
            post](https://developer.github.com/changes/2020-02-14-deprecating-oauth-auth-endpoint/).**Warning:**
            Apps must use the [web application
            flow](https://docs.github.com/enterprise-server@3.9/apps/building-oauth-apps/authorizing-oauth-apps/#web-application-flow)
            to obtain OAuth tokens that work with GitHub Enterprise Server SAML
            organizations. OAuth tokens created using the Authorizations API will be
            unable to access GitHub Enterprise Server SAML organizations. For more
            information, see the [blog
            post](https://developer.github.com/changes/2019-11-05-deprecated-passwords-and-authorizations-api).Creates
            a new authorization for the specified OAuth application, only if an
            authorization for that application doesn't already exist for the user.
            The URL includes the 20 character client ID for the OAuth app that is
            requesting the token. It returns the user's existing authorization for
            the application if one is present. Otherwise, it creates and returns a
            new one.If you have two-factor authentication setup, Basic
            Authentication for this endpoint requires that you use a one-time
            password (OTP) and your username and password instead of tokens. For
            more information, see "[Working with two-factor
            authentication](https://docs.github.com/enterprise-server@3.9/rest/overview/other-authentication-methods#working-with-two-factor-authentication)."**Deprecation
            Notice:** GitHub Enterprise Server will discontinue the [OAuth
            Authorizations
            API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations/),
            which is used by integrations to create personal access tokens and OAuth
            tokens, and you must now create these tokens using our [web application
            flow](https://docs.github.com/enterprise-server@3.9/developers/apps/authorizing-oauth-apps#web-application-flow).
            The [OAuth Authorizations
            API](https://docs.github.com/enterprise-server@3.9/rest/oauth-authorizations/oauth-authorizations)
            will be removed on November, 13, 2020. For more information, including
            scheduled brownouts, see the [blog
            post](https://developer.github.com/changes/2020-02-14-deprecating-oauth-auth-endpoint/).
          operationId: oauthauthorizationsgetorcreateauthorizationforapp
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  properties:
                    client_secret:
                      description: The OAuth app client secret for which to create the token.
                      maxLength: 40
                      type: string
                    scopes:
                      description: A list of scopes that this authorization is in.
                      type: array
                      items:
                        type: string
                      example:
                        - public_repo
                        - user
                      nullable: true
                    note:
                      description: A note to remind you what the OAuth token is for.
                      type: string
                      example: Update all gems
                    note_url:
                      description: A URL to remind you what app the OAuth token is for.
                      type: string
                    fingerprint:
                      description: >-
                        A unique string to distinguish an authorization from others
                        created for the same client ID and user.
                      type: string
                  required:
                    - client_secret
                  type: object
                examples:
                  default:
                    summary: Create an authorization for an app
                    value:
                      client_secret: 3ef4ad510c59ad37bac6bb4f80047fb3aee3cc7f
                      scopes:
                        - public_repo
                      note: optional note
                      note_url: http://optional/note/url
          responses:
            '422':
              $ref: '#/components/responses/validation_failed'
