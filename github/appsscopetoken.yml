apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Create A Scoped Access Token
  description: >-
    Use a non-scoped user access token to create a repository-scoped and/or
    permission-scoped user access token. You can specifywhich repositories the
    token can access and which permissions are granted to thetoken.Invalid
    tokens will return `404 NOT FOUND`.You must use [Basic
    Authentication](https://docs.github.com/enterprise-server@3.9/rest/overview/other-authentication-methods#basic-authentication)when
    accessing this endpoint, using the `client_id` and `client_secret` of the
    GitHub Appas the username and password.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Create A Scoped Access Token
      description: >-
        Use a non-scoped user access token to create a repository-scoped and/or
        permission-scoped user access token. You can specifywhich repositories the
        token can access and which permissions are granted to thetoken.Invalid
        tokens will return `404 NOT FOUND`.You must use [Basic
        Authentication](https://docs.github.com/enterprise-server@3.9/rest/overview/other-authentication-methods#basic-authentication)when
        accessing this endpoint, using the `client_id` and `client_secret` of the
        GitHub Appas the username and password.
    paths:
      /applications/{client_id}/token/scoped:
        post:
          summary: Create A Scoped Access Token
          description: >-
            Use a non-scoped user access token to create a repository-scoped and/or
            permission-scoped user access token. You can specifywhich repositories
            the token can access and which permissions are granted to
            thetoken.Invalid tokens will return `404 NOT FOUND`.You must use [Basic
            Authentication](https://docs.github.com/enterprise-server@3.9/rest/overview/other-authentication-methods#basic-authentication)when
            accessing this endpoint, using the `client_id` and `client_secret` of
            the GitHub Appas the username and password.
          operationId: appsscopetoken
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    access_token:
                      type: string
                      description: The access token used to authenticate to the GitHub API.
                      example: e72e16c7e42f292c6912e7710c838347ae178b4a
                    target:
                      description: >-
                        The name of the user or organization to scope the user
                        access token to. **Required** unless `target_id` is
                        specified.
                      type: string
                      example: octocat
                    target_id:
                      description: >-
                        The ID of the user or organization to scope the user access
                        token to. **Required** unless `target` is specified.
                      example: 1
                      type: integer
                    repositories:
                      description: >-
                        The list of repository names to scope the user access token
                        to. `repositories` may not be specified if `repository_ids`
                        is specified.
                      type: array
                      items:
                        type: string
                        example: rails
                    repository_ids:
                      description: >-
                        The list of repository IDs to scope the user access token
                        to. `repository_ids` may not be specified if `repositories`
                        is specified.
                      example:
                        - 1
                      type: array
                      items:
                        type: integer
                    permissions:
                      $ref: '#/components/schemas/app-permissions'
                  required:
                    - access_token
                examples:
                  default:
                    value:
                      access_token: e72e16c7e42f292c6912e7710c838347ae178b4a
                      target: octocat
                      permissions:
                        metadata: read
                        issues: write
                        contents: read
          responses:
            '422':
              $ref: '#/components/responses/validation_failed'
