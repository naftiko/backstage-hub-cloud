apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Update Code Security And Analysis Features For An Enterprise
  description: >-
    Updates the settings for advanced security, Dependabot alerts, secret
    scanning, and push protection for new repositories in an enterprise.The
    authenticated user must be an administrator of the enterprise to use this
    endpoint.OAuth app tokens and personal access tokens (classic) need the
    `admin:enterprise` scope to use this endpoint.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Update Code Security And Analysis Features For An Enterprise
      description: >-
        Updates the settings for advanced security, Dependabot alerts, secret
        scanning, and push protection for new repositories in an enterprise.The
        authenticated user must be an administrator of the enterprise to use this
        endpoint.OAuth app tokens and personal access tokens (classic) need the
        `admin:enterprise` scope to use this endpoint.
    paths:
      /enterprises/{enterprise}/code_security_and_analysis:
        patch:
          summary: Update Code Security And Analysis Features For An Enterprise
          description: >-
            Updates the settings for advanced security, Dependabot alerts, secret
            scanning, and push protection for new repositories in an enterprise.The
            authenticated user must be an administrator of the enterprise to use
            this endpoint.OAuth app tokens and personal access tokens (classic) need
            the `admin:enterprise` scope to use this endpoint.
          operationId: secretscanningpatchsecurityanalysissettingsforenterprise
          requestBody:
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    advanced_security_enabled_for_new_repositories:
                      type: boolean
                      description: >-
                        Whether GitHub Advanced Security is automatically enabled
                        for new repositories. For more information, see "[About
                        GitHub Advanced
                        Security](https://docs.github.com/enterprise-server@3.9/get-started/learning-about-github/about-github-advanced-security)."
                    dependabot_alerts_enabled_for_new_repositories:
                      type: boolean
                      description: >-
                        Whether Dependabot alerts are automatically enabled for new
                        repositories. For more information, see "[About Dependabot
                        alerts](https://docs.github.com/enterprise-server@3.9/code-security/dependabot/dependabot-alerts/about-dependabot-alerts)."
                    secret_scanning_enabled_for_new_repositories:
                      type: boolean
                      description: >-
                        Whether secret scanning is automatically enabled for new
                        repositories. For more information, see "[About secret
                        scanning](https://docs.github.com/enterprise-server@3.9/code-security/secret-scanning/about-secret-scanning)."
                    secret_scanning_push_protection_enabled_for_new_repositories:
                      type: boolean
                      description: >-
                        Whether secret scanning push protection is automatically
                        enabled for new repositories. For more information, see
                        "[Protecting pushes with secret
                        scanning](https://docs.github.com/enterprise-server@3.9/code-security/secret-scanning/protecting-pushes-with-secret-scanning)."
                    secret_scanning_push_protection_custom_link:
                      type: string
                      nullable: true
                      description: >-
                        The URL that will be displayed to contributors who are
                        blocked from pushing a secret. For more information, see
                        "[Protecting pushes with secret
                        scanning](https://docs.github.com/enterprise-server@3.9/code-security/secret-scanning/protecting-pushes-with-secret-scanning)."

                        To disable this functionality, set this field to `null`.
                examples:
                  default:
                    value:
                      advanced_security_enabled_for_new_repositories: true
                      advanced_security_enabled_new_user_namespace_repos: true
                      dependabot_alerts_enabled_for_new_repositories: true
                      secret_scanning_enabled_for_new_repositories: true
                      secret_scanning_push_protection_enabled_for_new_repositories: true
                      secret_scanning_push_protection_custom_link: https://github.com/test-org/test-repo/blob/main/README.md
          responses:
            '422':
              description: >-
                The action could not be taken due to an in progress enablement, or a
                policy is preventing enablement
