apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Create A New Event Webhook
  description: >-
    **This endpoint allows you to create a new Event Webhook.**When creating a
    webhook, you will provide a URL where you want the webhook to send POST
    requests, and you will select which events you want to receive in those
    request. See the [**Event Webhook
    Reference**](https://docs.sendgrid.com/for-developers/tracking-events/event#delivery-events)
    for details about each event type.### Webhook identifiersWhen your webhook
    is succesfully created, you will receive a webhook `id` in the response
    returned by this endpoint. You can use that ID to [update the webhook's
    settings](https://docs.sendgrid.com/api-reference/webhooks/update-an-event-webhook),
    [delete the
    webhook](https://docs.sendgrid.com/api-reference/webhooks/delete-an-event-webhook),
    [enable or disable signature verification for the
    webhook](https://docs.sendgrid.com/api-reference/webhooks/toggle-signature-verification-for-an-event-webhook),
    and, if signature verification is enabled, [retrieve the webhook's public
    key](https://docs.sendgrid.com/api-reference/webhooks/get-signed-event-webhooks-public-key).You
    may also assign an optional friendly name to each of your webhooks. The
    friendly name is for convenience only and should not be used to
    programmatically differentiate your webhooks because it does not need to be
    unique. Use the webhook ID to reliably differentiate among your webhooks.###
    OAuthYou can optionally configure OAuth verification for your webhook at the
    time of creation by passing the appropriate values in the `oauth_client_id`,
    `oauth_client_secret`, and `oauth_token_url` properties. You can enable or
    disable OAuth for the webhook after creation with the [**Update an Event
    Webhook**](https://docs.sendgrid.com/api-reference/webhooks/update-an-event-webhook)
    operation.You may share one OAuth configuration across all your webhooks or
    create unique credentials for each. See our [webhook security
    documentation](https://docs.sendgrid.com/for-developers/tracking-events/getting-started-event-webhook-security-features#oauth-20)
    for details about OAuth and the Event Webhook.### Signature
    verificationEnabling signature verification for your webhook is a separate
    process and cannot be done at the time of creation with this endpoint. You
    can use the webhook ID to [enable or disable signature verification with the
    endpoint dedicated for that
    operation](https://docs.sendgrid.com/api-reference/webhooks/toggle-signature-verification-for-an-event-webhook).
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Create A New Event Webhook
      description: >-
        **This endpoint allows you to create a new Event Webhook.**When creating a
        webhook, you will provide a URL where you want the webhook to send POST
        requests, and you will select which events you want to receive in those
        request. See the [**Event Webhook
        Reference**](https://docs.sendgrid.com/for-developers/tracking-events/event#delivery-events)
        for details about each event type.### Webhook identifiersWhen your webhook
        is succesfully created, you will receive a webhook `id` in the response
        returned by this endpoint. You can use that ID to [update the webhook's
        settings](https://docs.sendgrid.com/api-reference/webhooks/update-an-event-webhook),
        [delete the
        webhook](https://docs.sendgrid.com/api-reference/webhooks/delete-an-event-webhook),
        [enable or disable signature verification for the
        webhook](https://docs.sendgrid.com/api-reference/webhooks/toggle-signature-verification-for-an-event-webhook),
        and, if signature verification is enabled, [retrieve the webhook's public
        key](https://docs.sendgrid.com/api-reference/webhooks/get-signed-event-webhooks-public-key).You
        may also assign an optional friendly name to each of your webhooks. The
        friendly name is for convenience only and should not be used to
        programmatically differentiate your webhooks because it does not need to be
        unique. Use the webhook ID to reliably differentiate among your webhooks.###
        OAuthYou can optionally configure OAuth verification for your webhook at the
        time of creation by passing the appropriate values in the `oauth_client_id`,
        `oauth_client_secret`, and `oauth_token_url` properties. You can enable or
        disable OAuth for the webhook after creation with the [**Update an Event
        Webhook**](https://docs.sendgrid.com/api-reference/webhooks/update-an-event-webhook)
        operation.You may share one OAuth configuration across all your webhooks or
        create unique credentials for each. See our [webhook security
        documentation](https://docs.sendgrid.com/for-developers/tracking-events/getting-started-event-webhook-security-features#oauth-20)
        for details about OAuth and the Event Webhook.### Signature
        verificationEnabling signature verification for your webhook is a separate
        process and cannot be done at the time of creation with this endpoint. You
        can use the webhook ID to [enable or disable signature verification with the
        endpoint dedicated for that
        operation](https://docs.sendgrid.com/api-reference/webhooks/toggle-signature-verification-for-an-event-webhook).
    paths:
      /v3/user/webhooks/event/settings:
        post:
          summary: Create A New Event Webhook
          description: >-
            **This endpoint allows you to create a new Event Webhook.**When creating
            a webhook, you will provide a URL where you want the webhook to send
            POST requests, and you will select which events you want to receive in
            those request. See the [**Event Webhook
            Reference**](https://docs.sendgrid.com/for-developers/tracking-events/event#delivery-events)
            for details about each event type.### Webhook identifiersWhen your
            webhook is succesfully created, you will receive a webhook `id` in the
            response returned by this endpoint. You can use that ID to [update the
            webhook's
            settings](https://docs.sendgrid.com/api-reference/webhooks/update-an-event-webhook),
            [delete the
            webhook](https://docs.sendgrid.com/api-reference/webhooks/delete-an-event-webhook),
            [enable or disable signature verification for the
            webhook](https://docs.sendgrid.com/api-reference/webhooks/toggle-signature-verification-for-an-event-webhook),
            and, if signature verification is enabled, [retrieve the webhook's
            public
            key](https://docs.sendgrid.com/api-reference/webhooks/get-signed-event-webhooks-public-key).You
            may also assign an optional friendly name to each of your webhooks. The
            friendly name is for convenience only and should not be used to
            programmatically differentiate your webhooks because it does not need to
            be unique. Use the webhook ID to reliably differentiate among your
            webhooks.### OAuthYou can optionally configure OAuth verification for
            your webhook at the time of creation by passing the appropriate values
            in the `oauth_client_id`, `oauth_client_secret`, and `oauth_token_url`
            properties. You can enable or disable OAuth for the webhook after
            creation with the [**Update an Event
            Webhook**](https://docs.sendgrid.com/api-reference/webhooks/update-an-event-webhook)
            operation.You may share one OAuth configuration across all your webhooks
            or create unique credentials for each. See our [webhook security
            documentation](https://docs.sendgrid.com/for-developers/tracking-events/getting-started-event-webhook-security-features#oauth-20)
            for details about OAuth and the Event Webhook.### Signature
            verificationEnabling signature verification for your webhook is a
            separate process and cannot be done at the time of creation with this
            endpoint. You can use the webhook ID to [enable or disable signature
            verification with the endpoint dedicated for that
            operation](https://docs.sendgrid.com/api-reference/webhooks/toggle-signature-verification-for-an-event-webhook).
          operationId: createEventWebhook
          requestBody:
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/EventWebhookRequest'
                examples:
                  Request With OAuth Configured:
                    summary: >-
                      POST request body to create an Event Webhook with OAuth
                      configured.
                    value:
                      enabled: true
                      url: https://example.com/webhook-endpoint
                      group_resubscribe: true
                      delivered: false
                      group_unsubscribe: true
                      spam_report: true
                      bounce: true
                      deferred: true
                      unsubscribe: true
                      processed: false
                      open: true
                      click: true
                      dropped: true
                      friendly_name: Engagement Webhook
                      oauth_client_id: a835e7210bbb47edbfa71bdfc909b2d7
                      oauth_client_secret: 335a9b0c65324fd2a62e2953d4b158
                      oauth_token_url: https://oauthservice.example.com
                  Request Without OAuth Configured:
                    summary: >-
                      POST request body to create an Event Webhook without OAuth
                      configured.
                    value:
                      enabled: true
                      url: https://example.com/webhook-endpoint
                      group_resubscribe: true
                      delivered: false
                      group_unsubscribe: true
                      spam_report: true
                      bounce: true
                      deferred: true
                      unsubscribe: true
                      processed: false
                      open: true
                      click: true
                      dropped: true
                      friendly_name: Engagement Webhook
          responses:
            '400':
              description: Bad request
              content:
                application/json:
                  schema:
                    type: object
                    properties:
                      errors:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                              description: >-
                                The ID of a Webhook that exists on your account that
                                is already configured to send events to the endpoint
                                URL you provided.
                            message:
                              type: string
                              description: Error message.
                            url:
                              type: string
                              description: >-
                                The URL that is already configured as a Webhook
                                endpoint for one of your existing Webhooks.
                  examples:
                    Bad URL:
                      value:
                        errors:
                          - message: '''https://example.com'' is not a valid url'
                    Exists:
                      value:
                        errors:
                          - id: 123abc456def890ghi
                            message: >-
                              Webhook at 'https://example.com' already exists.
                              Please provide a unique URL.
                            url: https://example.com
                    Max webhooks reached:
                      value:
                        errors:
                          - message: >-
                              You have reached the maximum number of webhooks per
                              your current billing plan.
