apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Associate An Authenticated Domain With A Given User, For Up To Five Domains.
  description: >-
    **This endpoint allows you to associate a specific authenticated domain with
    a subuser. It can be used to associate up to five authenticated
    domains.**This functionality allows subusers to send mail using their
    parent's domain. Authenticated domains can be associated with (i.e. assigned
    to) subusers from a parent account. To associate an authenticated domain
    with a subuser, the parent account must first authenticate and validate the
    domain. The parent may then associate the authenticated domain via the
    subuser management tools.A subuser can have up to five associated
    authenticated domains. To see the domains that have already been associated
    with this user, you can [use the API to list the domains currently
    associated with the
    subuser](https://www.twilio.com/docs/sendgrid/api-reference/domain-authentication/list-the-authenticated-domain-associated-with-a-subuser-multiple).When
    selecting a domain to send email from, SendGrid checks for domains in the
    following order and chooses the first one that appears in the hierarchy: 1.
    Domain assigned by the subuser that matches the email's `From` address
    domain. 2. The subuser's default domain. 3. Domain assigned by the parent
    user that matches the `From` address domain. 4. Parent user's default
    domain. 5. sendgrid.net
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Associate An Authenticated Domain With A Given User, For Up To Five Domains.
      description: >-
        **This endpoint allows you to associate a specific authenticated domain with
        a subuser. It can be used to associate up to five authenticated
        domains.**This functionality allows subusers to send mail using their
        parent's domain. Authenticated domains can be associated with (i.e. assigned
        to) subusers from a parent account. To associate an authenticated domain
        with a subuser, the parent account must first authenticate and validate the
        domain. The parent may then associate the authenticated domain via the
        subuser management tools.A subuser can have up to five associated
        authenticated domains. To see the domains that have already been associated
        with this user, you can [use the API to list the domains currently
        associated with the
        subuser](https://www.twilio.com/docs/sendgrid/api-reference/domain-authentication/list-the-authenticated-domain-associated-with-a-subuser-multiple).When
        selecting a domain to send email from, SendGrid checks for domains in the
        following order and chooses the first one that appears in the hierarchy: 1.
        Domain assigned by the subuser that matches the email's `From` address
        domain. 2. The subuser's default domain. 3. Domain assigned by the parent
        user that matches the `From` address domain. 4. Parent user's default
        domain. 5. sendgrid.net
    paths:
      /v3/whitelabel/domains/{domain_id}/subuser:add:
        post:
          summary: >-
            Associate An Authenticated Domain With A Given User, For Up To Five
            Domains.
          description: >-
            **This endpoint allows you to associate a specific authenticated domain
            with a subuser. It can be used to associate up to five authenticated
            domains.**This functionality allows subusers to send mail using their
            parent's domain. Authenticated domains can be associated with (i.e.
            assigned to) subusers from a parent account. To associate an
            authenticated domain with a subuser, the parent account must first
            authenticate and validate the domain. The parent may then associate the
            authenticated domain via the subuser management tools.A subuser can have
            up to five associated authenticated domains. To see the domains that
            have already been associated with this user, you can [use the API to
            list the domains currently associated with the
            subuser](https://www.twilio.com/docs/sendgrid/api-reference/domain-authentication/list-the-authenticated-domain-associated-with-a-subuser-multiple).When
            selecting a domain to send email from, SendGrid checks for domains in
            the following order and chooses the first one that appears in the
            hierarchy: 1. Domain assigned by the subuser that matches the email's
            `From` address domain. 2. The subuser's default domain. 3. Domain
            assigned by the parent user that matches the `From` address domain. 4.
            Parent user's default domain. 5. sendgrid.net
          operationId: associateSubuserWithDomainMultiple
          requestBody:
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    username:
                      type: string
                      description: Username to associate with the authenticated domain.
                  required:
                    - username
                  example:
                    username: jdoe
          responses:
            '201':
              description: ''
              content:
                application/json:
                  schema:
                    $ref: '#/components/schemas/AuthenticatedDomainSpf'
                  examples:
                    response:
                      value:
                        id: 1
                        domain: example.com
                        subdomain: mail
                        username: jdoe
                        user_id: 7
                        ips: []
                        custom_spf: true
                        default: false
                        legacy: false
                        automatic_security: false
                        valid: false
                        dns:
                          mail_server:
                            host: mail.example.com
                            type: mx
                            data: sendgrid.net
                            valid: false
                          subdomain_spf:
                            host: mail.example.com
                            type: txt
                            data: v=spf1 ip4:192.168.1.1 ip4:192.168.0.1 -all
                            valid: false
                          domain_spf:
                            host: example.com
                            type: txt
                            data: v=spf1 include:mail.example.com -all
                            valid: false
                          dkim:
                            host: s1._domainkey.example.com
                            type: txt
                            data: k=rsa; t=s; p=publicKey
                            valid: false
