apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: microsoftAzurePoolDelete
  description: >-
    When you request that a Pool be deleted, the following actions occur: the
    Pool state is set to deleting; any ongoing resize operation on the Pool are
    stopped; the Batch service starts resizing the Pool to zero Compute Nodes;
    any Tasks running on existing Compute Nodes are terminated and requeued (as
    if a resize Pool operation had been requested with the default requeue
    option); finally, the Pool is removed from the system. Because running Tasks
    are requeued, the user can rerun these Tasks by updating their Job to target
    a different Pool. The Tasks can then run on the new Pool. If you want to
    override the requeue behavior, then you should call resize Pool explicitly
    to shrink the Pool to zero size before deleting the Pool. If you call an
    Update, Patch or Delete API on a Pool in the deleting state, it will fail
    with HTTP status code 409 with error code PoolBeingDeleted.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: 'Deletes A Pool From The Specified Account '
      description: >-
        When you request that a Pool be deleted, the following actions occur: the
        Pool state is set to deleting; any ongoing resize operation on the Pool are
        stopped; the Batch service starts resizing the Pool to zero Compute Nodes;
        any Tasks running on existing Compute Nodes are terminated and requeued (as
        if a resize Pool operation had been requested with the default requeue
        option); finally, the Pool is removed from the system. Because running Tasks
        are requeued, the user can rerun these Tasks by updating their Job to target
        a different Pool. The Tasks can then run on the new Pool. If you want to
        override the requeue behavior, then you should call resize Pool explicitly
        to shrink the Pool to zero size before deleting the Pool. If you call an
        Update, Patch or Delete API on a Pool in the deleting state, it will fail
        with HTTP status code 409 with error code PoolBeingDeleted.
    paths:
      /pools/{poolId}:
        delete:
          summary: 'Deletes A Pool From The Specified Account '
          description: >-
            When you request that a Pool be deleted, the following actions occur:
            the Pool state is set to deleting; any ongoing resize operation on the
            Pool are stopped; the Batch service starts resizing the Pool to zero
            Compute Nodes; any Tasks running on existing Compute Nodes are
            terminated and requeued (as if a resize Pool operation had been
            requested with the default requeue option); finally, the Pool is removed
            from the system. Because running Tasks are requeued, the user can rerun
            these Tasks by updating their Job to target a different Pool. The Tasks
            can then run on the new Pool. If you want to override the requeue
            behavior, then you should call resize Pool explicitly to shrink the Pool
            to zero size before deleting the Pool. If you call an Update, Patch or
            Delete API on a Pool in the deleting state, it will fail with HTTP
            status code 409 with error code PoolBeingDeleted.
          operationId: microsoftAzurePoolDelete
          responses:
            default:
              description: The error from the Batch service.
              schema:
                $ref: '#/definitions/BatchError'
