apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Create Or Update An Annotation
  description: >-
    Creates or updates an individual annotation for the specified
    report.Annotations are individual findings that have been identified as part
    of a report, for example, a line of code that represents a vulnerability.
    These annotations can be attached to a specific file and even a specific
    line in that file, however, that is optional. Annotations are not mandatory
    and a report can contain up to 1000 annotations.Just as reports, annotation
    needs to be uploaded with a unique ID that can later be used to identify the
    report as an alternative to the generated
    [UUID](https://developer.atlassian.com/bitbucket/api/2/reference/meta/uri-uuid#uuid).
    If you want to use an existing id from your own system, we recommend
    prefixing it with your system's name to avoid collisions, for example,
    mySystem-annotation001.### Sample cURL request:```curl --request PUT
    'https://api.bitbucket.org/2.0/repositories///commit//reports/mySystem-001/annotations/mysystem-annotation001'
    \--header 'Content-Type: application/json' \--data-raw '{    "title":
    "Security scan report",    "annotation_type": "VULNERABILITY",    "summary":
    "This line represents a security thread.",    "severity": "HIGH",    "path":
    "my-service/src/main/java/com/myCompany/mysystem/logic/Main.java",   
    "line": 42}'```### Possible field values:annotation_type: VULNERABILITY,
    CODE_SMELL, BUGresult: PASSED, FAILED, IGNORED, SKIPPEDseverity: HIGH,
    MEDIUM, LOW, CRITICALPlease refer to the [Code Insights
    documentation](https://confluence.atlassian.com/bitbucket/code-insights-994316785.html)
    for more information.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Create Or Update An Annotation
      description: >-
        Creates or updates an individual annotation for the specified
        report.Annotations are individual findings that have been identified as part
        of a report, for example, a line of code that represents a vulnerability.
        These annotations can be attached to a specific file and even a specific
        line in that file, however, that is optional. Annotations are not mandatory
        and a report can contain up to 1000 annotations.Just as reports, annotation
        needs to be uploaded with a unique ID that can later be used to identify the
        report as an alternative to the generated
        [UUID](https://developer.atlassian.com/bitbucket/api/2/reference/meta/uri-uuid#uuid).
        If you want to use an existing id from your own system, we recommend
        prefixing it with your system's name to avoid collisions, for example,
        mySystem-annotation001.### Sample cURL request:```curl --request PUT
        'https://api.bitbucket.org/2.0/repositories///commit//reports/mySystem-001/annotations/mysystem-annotation001'
        \--header 'Content-Type: application/json' \--data-raw '{    "title":
        "Security scan report",    "annotation_type": "VULNERABILITY",    "summary":
        "This line represents a security thread.",    "severity": "HIGH",    "path":
        "my-service/src/main/java/com/myCompany/mysystem/logic/Main.java",   
        "line": 42}'```### Possible field values:annotation_type: VULNERABILITY,
        CODE_SMELL, BUGresult: PASSED, FAILED, IGNORED, SKIPPEDseverity: HIGH,
        MEDIUM, LOW, CRITICALPlease refer to the [Code Insights
        documentation](https://confluence.atlassian.com/bitbucket/code-insights-994316785.html)
        for more information.
    paths:
      /repositories/{workspace}/{repo_slug}/commit/{commit}/reports/{reportId}/annotations/{annotationId}:
        put:
          summary: Create Or Update An Annotation
          description: >-
            Creates or updates an individual annotation for the specified
            report.Annotations are individual findings that have been identified as
            part of a report, for example, a line of code that represents a
            vulnerability. These annotations can be attached to a specific file and
            even a specific line in that file, however, that is optional.
            Annotations are not mandatory and a report can contain up to 1000
            annotations.Just as reports, annotation needs to be uploaded with a
            unique ID that can later be used to identify the report as an
            alternative to the generated
            [UUID](https://developer.atlassian.com/bitbucket/api/2/reference/meta/uri-uuid#uuid).
            If you want to use an existing id from your own system, we recommend
            prefixing it with your system's name to avoid collisions, for example,
            mySystem-annotation001.### Sample cURL request:```curl --request PUT
            'https://api.bitbucket.org/2.0/repositories///commit//reports/mySystem-001/annotations/mysystem-annotation001'
            \--header 'Content-Type: application/json' \--data-raw '{    "title":
            "Security scan report",    "annotation_type": "VULNERABILITY",   
            "summary": "This line represents a security thread.",    "severity":
            "HIGH",    "path":
            "my-service/src/main/java/com/myCompany/mysystem/logic/Main.java",   
            "line": 42}'```### Possible field values:annotation_type: VULNERABILITY,
            CODE_SMELL, BUGresult: PASSED, FAILED, IGNORED, SKIPPEDseverity: HIGH,
            MEDIUM, LOW, CRITICALPlease refer to the [Code Insights
            documentation](https://confluence.atlassian.com/bitbucket/code-insights-994316785.html)
            for more information.
          operationId: createOrUpdateAnnotation
          requestBody:
            description: The annotation to create or update
            required: true
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/report_annotation'
          responses:
            '400':
              description: The provided Annotation object is malformed or incomplete.
              content:
                application/json:
                  schema:
                    $ref: '#/components/schemas/error'
