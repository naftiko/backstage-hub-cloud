apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Update An Installed App
  description: >-
    Updates the application installation for the user.This endpoint is intended
    to be used by Bitbucket Connect appsand only supports JWT authentication --
    that is how Bitbucketidentifies the particular installation of the app.
    Developerswith applications registered in the "Develop Apps" sectionof
    Bitbucket need not use this endpoint as updates for thoseapplications can be
    sent out via the UI of that section.Passing an empty body will update the
    installation using theexisting descriptor URL.```$ curl -X PUT
    https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \  --header
    "Content-Type: application/json" \  --data '{}'```The new `descriptor` for
    the installation can be also providedin the body directly.```$ curl -X PUT
    https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \  --header
    "Content-Type: application/json" \  --data '{"descriptor":
    $NEW_DESCRIPTOR}'```In both these modes the URL of the descriptor cannot be
    changed. Tochange the descriptor location and upgrade an installationthe
    request must be made exclusively with a `descriptor_url`. ```$ curl -X PUT
    https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \  --header
    "Content-Type: application/json" \  --data '{"descriptor_url":
    $NEW_URL}'```The `descriptor_url` must exactly match the marketplace
    registrationthat Atlassian has for the application. Contact your
    Atlassiandeveloper advocate to update this registration. Once the
    registrationhas been updated you may call this resource for each
    installation.Note that the scopes of the application cannot be increasedin
    the new descriptor nor reduced to none.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Update An Installed App
      description: >-
        Updates the application installation for the user.This endpoint is intended
        to be used by Bitbucket Connect appsand only supports JWT authentication --
        that is how Bitbucketidentifies the particular installation of the app.
        Developerswith applications registered in the "Develop Apps" sectionof
        Bitbucket need not use this endpoint as updates for thoseapplications can be
        sent out via the UI of that section.Passing an empty body will update the
        installation using theexisting descriptor URL.```$ curl -X PUT
        https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \  --header
        "Content-Type: application/json" \  --data '{}'```The new `descriptor` for
        the installation can be also providedin the body directly.```$ curl -X PUT
        https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \  --header
        "Content-Type: application/json" \  --data '{"descriptor":
        $NEW_DESCRIPTOR}'```In both these modes the URL of the descriptor cannot be
        changed. Tochange the descriptor location and upgrade an installationthe
        request must be made exclusively with a `descriptor_url`. ```$ curl -X PUT
        https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \  --header
        "Content-Type: application/json" \  --data '{"descriptor_url":
        $NEW_URL}'```The `descriptor_url` must exactly match the marketplace
        registrationthat Atlassian has for the application. Contact your
        Atlassiandeveloper advocate to update this registration. Once the
        registrationhas been updated you may call this resource for each
        installation.Note that the scopes of the application cannot be increasedin
        the new descriptor nor reduced to none.
    paths:
      /addon:
        put:
          summary: Update An Installed App
          description: >-
            Updates the application installation for the user.This endpoint is
            intended to be used by Bitbucket Connect appsand only supports JWT
            authentication -- that is how Bitbucketidentifies the particular
            installation of the app. Developerswith applications registered in the
            "Develop Apps" sectionof Bitbucket need not use this endpoint as updates
            for thoseapplications can be sent out via the UI of that section.Passing
            an empty body will update the installation using theexisting descriptor
            URL.```$ curl -X PUT https://api.bitbucket.org/2.0/addon \  -H
            "Authorization: JWT " \  --header "Content-Type: application/json" \ 
            --data '{}'```The new `descriptor` for the installation can be also
            providedin the body directly.```$ curl -X PUT
            https://api.bitbucket.org/2.0/addon \  -H "Authorization: JWT " \ 
            --header "Content-Type: application/json" \  --data '{"descriptor":
            $NEW_DESCRIPTOR}'```In both these modes the URL of the descriptor cannot
            be changed. Tochange the descriptor location and upgrade an
            installationthe request must be made exclusively with a
            `descriptor_url`. ```$ curl -X PUT https://api.bitbucket.org/2.0/addon
            \  -H "Authorization: JWT " \  --header "Content-Type: application/json"
            \  --data '{"descriptor_url": $NEW_URL}'```The `descriptor_url` must
            exactly match the marketplace registrationthat Atlassian has for the
            application. Contact your Atlassiandeveloper advocate to update this
            registration. Once the registrationhas been updated you may call this
            resource for each installation.Note that the scopes of the application
            cannot be increasedin the new descriptor nor reduced to none.
          operationId: updateaninstalledapp
          responses:
            '403':
              description: Improper authentication.
              content:
                application/json:
                  schema:
                    $ref: '#/components/schemas/error'
