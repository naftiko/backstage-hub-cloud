apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Publish Draft Workflow Scheme
  description: >-
    Publishes a draft workflow scheme.Where the draft workflow includes new
    workflow statuses for an issue type, mappings are provided to update issues
    with the original workflow status to the new workflow status.This operation
    is [asynchronous](#async). Follow the `location` link in the response to
    determine the status of the task and use [Get
    task](#api-rest-api-3-task-taskId-get) to obtain
    updates.**[Permissions](#permissions) required:** *Administer Jira* [global
    permission](https://confluence.atlassian.com/x/x4dKLg).
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Publish Draft Workflow Scheme
      description: >-
        Publishes a draft workflow scheme.Where the draft workflow includes new
        workflow statuses for an issue type, mappings are provided to update issues
        with the original workflow status to the new workflow status.This operation
        is [asynchronous](#async). Follow the `location` link in the response to
        determine the status of the task and use [Get
        task](#api-rest-api-3-task-taskId-get) to obtain
        updates.**[Permissions](#permissions) required:** *Administer Jira* [global
        permission](https://confluence.atlassian.com/x/x4dKLg).
    paths:
      /rest/api/3/workflowscheme/{id}/draft/publish:
        post:
          summary: Publish Draft Workflow Scheme
          description: >-
            Publishes a draft workflow scheme.Where the draft workflow includes new
            workflow statuses for an issue type, mappings are provided to update
            issues with the original workflow status to the new workflow status.This
            operation is [asynchronous](#async). Follow the `location` link in the
            response to determine the status of the task and use [Get
            task](#api-rest-api-3-task-taskId-get) to obtain
            updates.**[Permissions](#permissions) required:** *Administer Jira*
            [global permission](https://confluence.atlassian.com/x/x4dKLg).
          operationId: publishDraftWorkflowScheme
          requestBody:
            description: Details of the status mappings.
            required: true
            content:
              application/json:
                example:
                  statusMappings:
                    - issueTypeId: '10001'
                      newStatusId: '1'
                      statusId: '3'
                    - issueTypeId: '10001'
                      newStatusId: '2'
                      statusId: '2'
                    - issueTypeId: '10002'
                      newStatusId: '10003'
                      statusId: '10005'
                    - issueTypeId: '10003'
                      newStatusId: '1'
                      statusId: '4'
                schema:
                  $ref: '#/components/schemas/PublishDraftWorkflowScheme'
          responses:
            '404':
              content:
                application/json:
                  example: >-
                    {"errorMessages":["Draft workflow scheme was not
                    found."],"errors":{}}
              description: |-
                Returned if any of these are true:

                 *  The workflow scheme is not found.
                 *  The workflow scheme does not have a draft.
                 *  A new status in the draft workflow scheme is not found.
