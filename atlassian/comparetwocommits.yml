apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Compare Two Commits
  description: >-
    Produces a raw git-style diff.#### Single commit specIf the `spec` argument
    to this API is a single commit, the diff isproduced against the first parent
    of the specified commit.#### Two commit specTwo commits separated by `..`
    may be provided as the `spec`, e.g.,`3a8b42..9ff173`. When two commits are
    provided and the `topic` queryparameter is true, this API produces a 2-way
    three dot diff.This is the diff between source commit and the merge base of
    the sourcecommit and the destination commit. When the `topic` query param is
    false,a simple git-style diff is produced.The two commits are interpreted as
    follows:* First commit: the commit containing the changes we wish to
    preview* Second commit: the commit representing the state to which we want
    to  compare the first commit* **Note**: This is the opposite of the order
    used in `git diff`.#### Comparison to patchesWhile similar to patches,
    diffs:* Don't have a commit header (username, commit message, etc)* Support
    the optional `path=foo/bar.py` query param to filter  the diff to just that
    one file diff#### ResponseThe raw diff is returned as-is, in whatever
    encoding the files in therepository use. It is not decoded into unicode. As
    such, thecontent-type is `text/plain`.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Compare Two Commits
      description: >-
        Produces a raw git-style diff.#### Single commit specIf the `spec` argument
        to this API is a single commit, the diff isproduced against the first parent
        of the specified commit.#### Two commit specTwo commits separated by `..`
        may be provided as the `spec`, e.g.,`3a8b42..9ff173`. When two commits are
        provided and the `topic` queryparameter is true, this API produces a 2-way
        three dot diff.This is the diff between source commit and the merge base of
        the sourcecommit and the destination commit. When the `topic` query param is
        false,a simple git-style diff is produced.The two commits are interpreted as
        follows:* First commit: the commit containing the changes we wish to
        preview* Second commit: the commit representing the state to which we want
        to  compare the first commit* **Note**: This is the opposite of the order
        used in `git diff`.#### Comparison to patchesWhile similar to patches,
        diffs:* Don't have a commit header (username, commit message, etc)* Support
        the optional `path=foo/bar.py` query param to filter  the diff to just that
        one file diff#### ResponseThe raw diff is returned as-is, in whatever
        encoding the files in therepository use. It is not decoded into unicode. As
        such, thecontent-type is `text/plain`.
    paths:
      /repositories/{workspace}/{repo_slug}/diff/{spec}:
        get:
          summary: Compare Two Commits
          description: >-
            Produces a raw git-style diff.#### Single commit specIf the `spec`
            argument to this API is a single commit, the diff isproduced against the
            first parent of the specified commit.#### Two commit specTwo commits
            separated by `..` may be provided as the `spec`, e.g.,`3a8b42..9ff173`.
            When two commits are provided and the `topic` queryparameter is true,
            this API produces a 2-way three dot diff.This is the diff between source
            commit and the merge base of the sourcecommit and the destination
            commit. When the `topic` query param is false,a simple git-style diff is
            produced.The two commits are interpreted as follows:* First commit: the
            commit containing the changes we wish to preview* Second commit: the
            commit representing the state to which we want to  compare the first
            commit* **Note**: This is the opposite of the order used in `git
            diff`.#### Comparison to patchesWhile similar to patches, diffs:* Don't
            have a commit header (username, commit message, etc)* Support the
            optional `path=foo/bar.py` query param to filter  the diff to just that
            one file diff#### ResponseThe raw diff is returned as-is, in whatever
            encoding the files in therepository use. It is not decoded into unicode.
            As such, thecontent-type is `text/plain`.
          operationId: comparetwocommits
          responses:
            '555':
              description: |-
                If the diff was too large and timed out.

                Since this endpoint does not employ any form of pagination, but
                instead returns the diff as a single document, it can run into
                trouble on very large diffs. If Bitbucket times out in cases
                like these, a 555 status code is returned.
              content:
                application/json:
                  schema:
                    $ref: '#/components/schemas/error'
