apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Update An Existing Rule
  description: >-
    Update an existing rule. When updating `cases`, `queries` or `options`, the
    whole fieldmust be included. For example, when modifying a query all queries
    must be included.Default rules can only be updated to be enabled, to change
    notifications, or to updatethe tags (default tags cannot be removed).
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Update An Existing Rule
      description: >-
        Update an existing rule. When updating `cases`, `queries` or `options`, the
        whole fieldmust be included. For example, when modifying a query all queries
        must be included.Default rules can only be updated to be enabled, to change
        notifications, or to updatethe tags (default tags cannot be removed).
    paths:
      /api/v2/security_monitoring/rules/{rule_id}:
        put:
          summary: Update An Existing Rule
          description: >-
            Update an existing rule. When updating `cases`, `queries` or `options`,
            the whole fieldmust be included. For example, when modifying a query all
            queries must be included.Default rules can only be updated to be
            enabled, to change notifications, or to updatethe tags (default tags
            cannot be removed).
          operationId: updateSecurityMonitoringRule
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/SecurityMonitoringRuleUpdatePayload'
          responses:
            '429':
              $ref: '#/components/responses/TooManyRequestsResponse'
