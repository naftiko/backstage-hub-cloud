apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Create Or Update Service Definition
  description: Create or update service definition in the Datadog Service Catalog.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Create Or Update Service Definition
      description: Create or update service definition in the Datadog Service Catalog.
    paths:
      /api/v2/services/definitions:
        post:
          summary: Create Or Update Service Definition
          description: Create or update service definition in the Datadog Service Catalog.
          operationId: createorupdateservicedefinition
          requestBody:
            content:
              application/json:
                schema:
                  type: object
                  example:
                    schema-version: v2.2
                    dd-service: my-service
                    application: my-app
                    ci-pipeline-fingerprints:
                      - j88xdEy0J5lc
                      - eZ7LMljCk8vo
                    contacts:
                      - type: slack
                        contact: https://teams.microsoft.com/myteam
                        name: My team channel
                      - type: slack
                        contact: https://teams.microsoft.com/myteam
                        name: My team channel
                    description: My service description
                    extensions:
                      myorg/extension: extensionValue
                    integrations:
                      opsgenie:
                        service-url: >-
                          https://my-org.opsgenie.com/service/123e4567-e89b-12d3-a456-426614174000
                        region: US
                      pagerduty:
                        service-url: https://my-org.pagerduty.com/service-directory/PMyService
                    languages:
                      - dotnet
                      - go
                      - java
                      - js
                      - php
                      - python
                      - ruby
                      - c++
                    lifecycle: sandbox
                    links:
                      - name: Runbook
                        type: runbook
                        url: https://my-runbook
                        provider: Github
                      - name: Runbook
                        type: runbook
                        url: https://my-runbook
                        provider: Github
                    tags:
                      - my:tag
                      - service:tag
                    team: my-team
                    tier: High
                    type: web
          responses:
            '429':
              description: Too Many Requests
              headers:
                Content-Type:
                  schema:
                    type: string
                    example: application/json
              content:
                application/json:
                  schema:
                    type: object
                  example:
                    errors:
                      - Bad Request
                      - Bad Request
