apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: Validate A Monitor
  description: >-
    Validate the monitor provided in the request.**Note**: Log monitors require
    an unscoped App Key.
  tags: []
  links:
    - title: Link
      icon: code
      url: https://example.com
spec:
  type: openapi
  lifecycle: experimental
  owner: team-c
  definition: |
    openapi: 3.1.0
    info:
      title: Validate A Monitor
      description: >-
        Validate the monitor provided in the request.**Note**: Log monitors require
        an unscoped App Key.
    paths:
      /api/v1/monitor/validate:
        post:
          summary: Validate A Monitor
          description: >-
            Validate the monitor provided in the request.**Note**: Log monitors
            require an unscoped App Key.
          operationId: validateamonitor
          requestBody:
            content:
              application/json:
                schema:
                  type: object
                  example:
                    type: query alert
                    query: avg(last_5m):sum:system.net.bytes_rcvd{host:host0} > 100
                    created: '1977-02-24T00:55:39.149Z'
                    creator:
                      email: eu do sit ex
                      handle: aliquip cupidatat ut ut
                      name: aute anim esse mollit et
                    deleted: '2005-10-04T10:03:03.282Z'
                    id: -85100539
                    matching_downtimes:
                      - id: 1625
                        end: 1412792983
                        scope:
                          - env:staging
                        start: 1412792983
                      - id: 1625
                        end: 1412792983
                        scope:
                          - env:staging
                        start: 1412792983
                    message: nisi sed Ut
                    modified: '1994-05-25T16:32:06.852Z'
                    multi: true
                    name: My monitor
                    options:
                      aggregation:
                        group_by: host
                        metric: metrics.name
                        type: count
                      enable_logs_sample: false
                      enable_samples: false
                      escalation_message: sint aliquip
                      evaluation_delay: -32193217
                      group_retention_duration: sunt magna
                      groupby_simple_monitor: false
                      include_tags: true
                      min_failure_duration: 0
                      min_location_failed: 1
                      new_group_delay: -74956346
                      no_data_timeframe: 10290724
                      notification_preset_name: show_all
                      notify_audit: false
                      notify_by:
                        - laboris amet mollit
                        - 'laboris '
                      notify_no_data: false
                      on_missing_data: show_and_notify_no_data
                      renotify_interval: null
                      renotify_occurrences: 53731472
                      renotify_statuses:
                        - alert
                        - alert
                      require_full_window: false
                      scheduling_options:
                        custom_schedule:
                          recurrences:
                            - rrule: FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR
                              start: '2023-08-31T16:30:00'
                              timezone: Europe/Paris
                            - rrule: FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR
                              start: '2023-08-31T16:30:00'
                              timezone: Europe/Paris
                        evaluation_window:
                          day_starts: '04:00'
                          hour_starts: 0
                          month_starts: 1
                      threshold_windows:
                        recovery_window: laborum dolor ut
                        trigger_window: occaecat veniam
                      thresholds:
                        critical: 52502101.190716386
                        critical_recovery: 33037203.80033295
                        ok: 14658043.747987643
                        unknown: 2305380.307081431
                        warning: 54314333.28059968
                        warning_recovery: 14656234.927481294
                      timeout_h: null
                      variables:
                        - data_source: rum
                          compute:
                            aggregation: avg
                            interval: 60000
                            metric: '@duration'
                          name: query_errors
                          group_by:
                            - facet: status
                              limit: 10
                              sort:
                                aggregation: avg
                                metric: ullamco sunt
                                order: desc
                            - facet: status
                              limit: 10
                              sort:
                                aggregation: avg
                                metric: nulla ea aliquip
                                order: desc
                          indexes:
                            - days-3
                            - days-7
                          search:
                            query: service:query
                        - data_source: rum
                          compute:
                            aggregation: avg
                            interval: 60000
                            metric: '@duration'
                          name: query_errors
                          group_by:
                            - facet: status
                              limit: 10
                              sort:
                                aggregation: avg
                                metric: sed dolor
                                order: desc
                            - facet: status
                              limit: 10
                              sort:
                                aggregation: avg
                                metric: veniam ullamco voluptate magna mollit
                                order: desc
                          indexes:
                            - days-3
                            - days-7
                          search:
                            query: service:query
                    overall_state: Warn
                    priority: 2
                    restricted_roles:
                      - Lorem exercitation
                      - sunt consectetur Excepteur
                    state:
                      groups:
                        idd:
                          last_nodata_ts: -84384069
                          last_notified_ts: -21864917
                          last_resolved_ts: -84458867
                          last_triggered_ts: 97076299
                          name: id mollit commodo
                          status: Alert
                        adipisicing_8:
                          last_nodata_ts: -58086015
                          last_notified_ts: -22268177
                          last_resolved_ts: -43962499
                          last_triggered_ts: -58469500
                          name: quis
                          status: Alert
                    tags:
                      - dolor exercitation Lorem veniam
                      - eu cupidat
          responses:
            '429':
              description: Too Many Requests
              headers:
                Content-Type:
                  schema:
                    type: string
                    example: application/json
              content:
                application/json:
                  schema:
                    type: object
                  example:
                    errors:
                      - Bad Request
                      - Bad Request
